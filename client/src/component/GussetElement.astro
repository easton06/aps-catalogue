---
import Image from "./Image.astro";
import Table from "./Table.astro";

const fetchedData = await fetch("http://localhost:5555/aps/Gusset%20Element").then(response => response.json())
---

{
  fetchedData.status === "ok"? 
    fetchedData.value.slice(1).map((entry: string[], i : number) =>
      <tr>
        <td class={`break-inside-avoid-page ${i < fetchedData.value.length - 1 ? "pb-4" : ""}`}>
          <div id={entry[1]} class="bg-indigo-800 py-3 px-12 text-white text-lg font-serif border-b-4 border-b-indigo-100">
            <h1>{entry[1]} </h1>
          </div>
          <div class="grid grid-cols-2 px-12 py-2">
            <div class="flex justify-center items-start flex-wrap gap-3">
              <Image entry={entry[4]} />
              <Image entry={entry[5] + "(" + entry[0] + ")"} />
            </div>
            <div class="px-2">
              <div>
                <Table raw={[["Part No", "Weight (g)"], [entry[0], entry[3]]]} />
              </div>
              <p class="pt-2 px-3">
                Material: 
                <span class="text-white py-1 mx-1 px-2 rounded-full bg-black">
                  {entry[2]}
                </span>
              </p>
            </div>
          </div>
          
        </td>
      </tr>
  )
  :
  <div>Error: {fetchedData.value}</div>
}